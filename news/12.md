# AI炼金术革新化学：MIT学者使用生成式AI，六秒生成新化学反应

从「等价交换」的远古炼金术开始，化学一直是一门了解和控制物质间相互作用的学科。人们经过不断解锁和利用新的化学反应，研发出了一系列新材料。在为人们生活提供便利的同时也提升了能量利用效率，促进可持续发展。

一个基元化学反应由反应物，过渡态（TS），生成物三者构成。过渡态是化学中至关重要的 3D 结构，被广泛用于理解化学反应机制、估算反应能垒以及探索庞大的反应网络。然而，由于其在反应过程中存在的时间极短（飞秒量级），实验中几乎不可能分离和表征过渡态。

常规情况下，人们使用量子化学的计算方法，通过反复求解薛定谔方程，以确定已知反应物和生成物之间的过渡态。然而，这种计算方法较为昂贵，并以经常失败而「臭名远扬」。同时，该方法受限于个人的经验直觉和计算所需的资源，每个人所能探索的化学反应也是局限的。这种限制在研究未知的复杂反应时尤为「致命」。它会使研究者忽略一些潜在可能发生的反应，导致会反应机理的误判，进而影响催化材料设计的思路。

针对这一问题，麻省理工学院（MIT）的一组研究人员开发出了一种基于机器学习的替代方法，能够在几秒钟内发现这些结构。他们的新模型可以协助化学家探索和设计新的反应和催化剂，从而生成高附加值的有用产品，例如燃料化合物或药物。此外，该模型还能够模拟自然发生的化学反应，如那些推动早期地球上生命演化的关键反应。

「过渡态作为设计催化剂或了解自然系统如何执行某些转化的起点，知道其具体结构十分重要。」MIT 化学工程和化学教授 Heather Kulik 说道。

相关研究工作以「​*Accurate transition state generation with an object-aware equivariant elementary reaction diffusion model*​」为题发表在国际顶级期刊《​*Nature Computational Science*​》上。

其中麻省理工学院的段辰儒博士是第一加通讯作者 [*https://rdcu.be/dtGSF*]。此外，康奈尔大学博士生杜沅岂，麻省理工学院博士生贾皓钧以及麻省理工学院Heather Kulik 教授为该论文的共同作者。

![图片](https://pic.imgdb.cn/item/65f009469f345e8d03d41950.png)

**论文链接：***https://www.nature.com/articles/s43588-023-00563-7*

**MIT News 也报道了该研究。**

![图片](https://pic.imgdb.cn/item/65f009549f345e8d03d45528.png)

报道链接：*https://news.mit.edu/2023/computational-model-captures-elusive-transition-states-1215*

**理论难点**

现阶段，化学家可以使用一种基于密度泛函理论的量子化学计算方法来计算过渡态。然而，这种方法需要大量的计算资源，需要数小时甚至数天才能完成一个过渡态的计算。

为了解决计算时间久的问题，一些研究人员在近期开始尝试使用机器学习模型来发现过渡态结构。然而，迄今为止几乎所有开发的模型都要求将两个反应物建模为一个整体，而反应物之间相对于彼此则保持特定的几何构型（conformation）。任何其他可能的构型都会被机器学习模型误认为成一个新的反应。

「如果反应物分子被旋转，那么从原理上讲，在旋转之前和之后它们仍然可以经历相同的化学反应。就像我们在谈论电解水的时候，只会说水在特定条件下转换为氧气和氢气，而不会描述这些分子的相对几何位置。但在传统的机器学习方法中，模型将把反应物和生成物在不同几何位置的反应视为两个不同的反应。这使得机器学习训练变得更加困难，准确性也会随之下降。」段辰儒博士表示。

扩散模型作为一个生成式模型曾被应用于图像处理中。最近，扩散模型还被应用于 3D 分子和蛋白结构生成、蛋白质-配体对接以及基于结构的药物设计。在这些应用中，扩散模型利用 3D special Euclidean group (SE(3)) 图神经网络（GNNs）来保留分子的排列、平移和旋转对称性。然而，由反应物、过渡态和产物组成的基元反应却遵循「对象感知」的 SE(3) 对称性。这是因为基元反应中三个对象之间的相互作用不是通过 3D 欧几里得空间进行的，而是在更高维的电子势能面（potential energy surface）的因果联系。因此，现有的基于 SE(3)  GNN 的扩散模型会因为破坏对称性而存在问题。

![图片](https://pic.imgdb.cn/item/65f009619f345e8d03d482a3.png)

图示：「对象感知」SE(3) 等变及其基于 SE(3) 等变 GNN 的实现。（来源：论文）

**解决方案**

麻省理工学院的团队根据以上问题开发了一种新的方法，叫做「OA-ReactDiff」。该团队将 SE(3) 等变 GNN 调整为「对象感知」模拟，即在保持单个对象的 SE(3) 等变性的同时，保持它们在欧几里得空间中独立的相互作用。

「扩散模型属于生成式人工智能领域，通过随机过程捕捉简单分布与复杂分布之间的转化。一旦模型学到了这三种结构如何共存的基本分布，我们可以给它新的反应物和生成物，它将尝试生成与这些反应物和生成物相对应的过渡态结构。」段辰儒博士说。

![图片](https://pic.imgdb.cn/item/65f0096d9f345e8d03d4b459.png)

图示：用于生成分子系统采样的等变扩散模型 (EDM) 概述。（来源：论文）

在训练集中，研究人员使用量子计算方法得到了 9,000 种不同化学反应的反应物、过渡态和生成物结构。并在约 1,000 个之前未见过的反应上进行了测试，要求它为每个过渡态生成 40 种可能的结构。

在计算的过程中通过引入「推荐模型」来预测哪个过渡态的置信度最高。在此基础上进一步结合不确定性估计，研究人员在仅对 14% 模型不确定性最高的反应执行量子化学计算，就实现了 2.6 kcal/mol 的平均绝对误差。这使得在使用 OA-ReactDiff 估算 300°C 的反应速率时，可以得到一个数量级误差范围内的结果。OA-ReactDiff 生成的结构与量子化学计算得到的过渡态结构相比，均方根误差 (RMSD) 在 0.06 埃（千分之六纳米）范围内，这个误差量级在肉眼中几乎不可区分。

更令人欣喜的是 OA-ReactDiff 生成一个过渡态结构只需要 6 秒，相比于量子化学计算至少加速了 1000 倍。由此，该算法成功实现了对 TS 结构和反应能垒计算的极高准确性和快速性。

![图片](https://pic.imgdb.cn/item/65f009799f345e8d03d4e410.png)

图示：评估 OA-ReactDiff 生成的 TS 结构与真实 TS 结构的结构相似性。（来源：论文）

Kulik 教授也感慨道，「之前我们很难想象在一念之间就能生成数千个过渡态。」

![图片](https://pic.imgdb.cn/item/65f009859f345e8d03d511c7.png)

图示：OA-ReactDiff plus 推荐 TS 结构的能量性能。（来源：论文）

**未来期许**

这项工作是 3D 扩散模型首次在化学反应中的亮相。尽管研究人员仅对较小数量原子的化合物（<25 个原子）的反应上进行了模拟训练，但他们发现整个模型也能够对较大分子的反应进行准确预测。

Kulik教授说：「即使你面对更大的系统甚至是酶催化的系统，你仍然可以得到关于原子最有可能重新排列的不同方式」。

研究人员现在计划加入其他组分来扩展他们的模型，比如催化剂。借助生成式 AI 的随机性，OA-ReactDiff 可以探索到意料之外的化学反应。这个特点弥补了现有基于化学的直觉反应探索框架，帮助建立更加完整的化学反应网络，助力研发设计新型催化材料。这方面的研究可以帮助他们加速发掘特定反应的新的催化剂。此外，他们提出的算法对于开发药品、燃料或其他有用化合物的新过程可能非常有用，尤其是当合成涉及许多化学步骤时。

「传统上，所有这些计算都是用量子化学进行的，而现在我们能够用更快的生成模型替代量子化学。」段辰儒博士说。

研究人员也表示化学反应是化学研究的核心。除了催化剂设计这种偏「工业型」的可能，OA-ReactDiff 还有许多有意思的潜在应用，如探索可能发生在其他行星上的气体间相互作用，模拟地球早期生命演化过程中发生的反应过程等等。

***本文转载自ScienceAI**

